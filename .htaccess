<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /

  # Handle React routing
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule ^ index.html [QSA,L]

  # Redirect HTTP to HTTPS in production
  RewriteCond %{HTTPS} off
  RewriteCond %{HTTP_HOST} !^localhost
  RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

  # Prevent directory listing
  Options -Indexes

  # Protect .env file
  <Files .env>
    Order allow,deny
    Deny from all
  </Files>

  # Protect configuration files
  <FilesMatch "^\.">
    Order allow,deny
    Deny from all
  </FilesMatch>
</IfModule>