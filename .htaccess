# Enable following symbolic links
Options +FollowSymLinks

# Enable rewrite engine
RewriteEngine On

# If the request is for an existing file or directory, serve it directly
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# Handle API requests - make sure PHP files are processed
RewriteCond %{REQUEST_URI} ^/api/
RewriteCond %{REQUEST_URI} \.php$ [NC]
RewriteRule ^api/(.*)$ api/$1 [L]

# If the request is for a static file, don't rewrite
RewriteCond %{REQUEST_URI} \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$
RewriteRule ^ - [L]

# Rewrite all other requests to index.html
RewriteRule ^ index.html [L]

# Set security headers
Header set X-Content-Type-Options "nosniff"
Header set X-Frame-Options "DENY"
Header set X-XSS-Protection "1; mode=block"

# Enable CORS
Header set Access-Control-Allow-Origin "*"
Header set Access-Control-Allow-Methods "GET, POST, OPTIONS"
Header set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With"